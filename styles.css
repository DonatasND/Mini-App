:root {
  font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
}

*,
*::before,
*::after {
  box-sizing:border-box;
  -webkit-tap-highlight-color:transparent;
}

html, body {
  overflow-x:hidden;
}

body {
  margin:0;
  padding:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:stretch;
  background:
    radial-gradient(circle at 0% 0%, rgba(71,186,255,0.16), transparent 55%),
    radial-gradient(circle at 100% 100%, rgba(129,80,255,0.18), transparent 55%),
    linear-gradient(145deg,#05060a,#080910,#050509);
  color:var(--tg-theme-text-color,#f8fbff);
}

button {
  font-family:inherit;
  -webkit-tap-highlight-color:transparent;
  outline:none;
  border:none;
}

/* –ó–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —ç–∫—Ä–∞–Ω */

.splash-screen {
  position:fixed;
  inset:0;
  background:#05060a;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:999;
  opacity:1;
  transition:opacity .5s ease;
  overflow:hidden;
}

.splash-screen.splash-hide {
  opacity:0;
  pointer-events:none;
}

.splash-img {
  width:100%;
  height:100%;
  object-fit:cover;
}

/* APP */

.app {
  min-height:100vh;
  max-width:480px;
  width:100%;
  display:flex;
  flex-direction:column;
  padding:14px;
  padding-top:calc(100px + env(safe-area-inset-top, 0px));
  padding-bottom:80px;
  gap:12px;
}

body.in-game .app {
  padding-bottom:10px;
}

/* HEADER */

.header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
}

.rating-pill {
  border-radius:999px;
  padding:6px 10px;
  background:linear-gradient(
    135deg,
    rgba(255,255,255,0.05),
    rgba(255,255,255,0.01)
  );
  border:1px solid rgba(255,255,255,0.16);
  backdrop-filter:blur(14px) saturate(150%);
  -webkit-backdrop-filter:blur(14px) saturate(150%);
  display:flex;
  flex-direction:column;
  gap:2px;
  max-width:55%;
}

.rating-label {
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:0.08em;
  opacity:.75;
}

.rating-values {
  font-size:12px;
  display:flex;
  flex-wrap:wrap;
  gap:4px;
  align-items:center;
}

.rating-separator {
  opacity:.6;
}

#rating-current {
  font-weight:600;
}

#rating-last {
  opacity:.8;
}

/* PROFILE PILL */

.profile-pill {
  display:flex;
  align-items:center;
  gap:8px;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,0.18);
  background:linear-gradient(
    135deg,
    rgba(255,255,255,0.06),
    rgba(255,255,255,0.02)
  );
  backdrop-filter:blur(16px) saturate(160%);
  -webkit-backdrop-filter:blur(16px) saturate(160%);
  cursor:pointer;
  transition:transform .15s ease,opacity .15s ease;
  color:inherit;
}

.profile-pill:active {
  transform:scale(.96);
  opacity:.9;
}

.profile-text {
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:2px;
}

.profile-name {
  font-size:13px;
  font-weight:600;
}

.profile-label {
  font-size:11px;
  opacity:.7;
}

.profile-avatar {
  width:32px;
  height:32px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  font-size:15px;
  color:#05121d;
  background:
    radial-gradient(circle at 30% 20%,#ffffff,rgba(255,255,255,0)),
    linear-gradient(135deg,#7ecaff,#508fff);
  box-shadow:
    0 0 12px rgba(126,202,255,0.8),
    0 8px 16px rgba(0,0,0,0.7);
}

/* MAIN */

.main {
  flex:1;
  display:flex;
  align-items:stretch;
  justify-content:center;
}

.glass-card {
  flex:1;
  border-radius:22px;
  padding:16px 14px 18px;
  background:linear-gradient(
    145deg,
    rgba(255,255,255,0.1),
    rgba(255,255,255,0.02)
  );
  border:1px solid rgba(255,255,255,0.18);
  box-shadow:
    0 20px 55px rgba(0,0,0,0.8),
    0 0 0 1px rgba(255,255,255,0.03);
  backdrop-filter:blur(24px) saturate(170%);
  -webkit-backdrop-filter:blur(24px) saturate(170%);
  display:flex;
  flex-direction:column;
  gap:12px;
  transition:box-shadow .15s ease,border-color .15s ease;
  max-width:100%;
  overflow:hidden;
}

.glass-card.game-mode {
  padding-bottom:110px;
}

/* —Ñ–ª—ç—à –æ—à–∏–±–∫–∏ */

.error-flash {
  box-shadow:
    0 0 0 1px rgba(255,80,80,0.6),
    0 0 24px rgba(255,60,60,0.9),
    0 0 80px rgba(255,0,0,0.65);
  border-color:rgba(255,120,120,0.9);
}

/* BP –æ—Å—Ç—Ä–æ–≤–æ–∫ */

.bp-island {
  border-radius:18px;
  padding:10px 10px 12px;
  background:rgba(7,10,20,0.9);
  border:1px solid rgba(255,255,255,0.18);
}

.bp-block {
  display:flex;
  flex-direction:column;
  gap:6px;
}

.bp-header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}

.bp-title {
  font-size:14px;
  font-weight:600;
}

.bp-level {
  font-size:13px;
  padding:3px 8px;
  border-radius:999px;
  background:rgba(6,18,35,0.85);
  border:1px solid rgba(120,192,255,0.6);
}

.bp-bar {
  width:100%;
  height:14px;
  border-radius:999px;
  background:rgba(255,255,255,0.14);
  overflow:hidden;
  position:relative;
}

.bp-fill {
  position:absolute;
  inset:0;
  width:0;
  border-radius:999px;
  background:linear-gradient(90deg,#43aaff,#77ddff);
  box-shadow:0 0 18px rgba(90,200,255,0.7);
  transition:width .4s ease;
}

.bp-sub {
  font-size:11px;
  opacity:.75;
}

/* –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ –±–ª–æ–∫–∏ */

.content-block {
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-top:4px;
}

.section-label {
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:0.12em;
  opacity:.75;
}

/* —Ä–µ–∂–∏–º—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–π */

.mode-grid-two {
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:8px;
  margin-top:4px;
}

.mode-grid-single {
  margin-top:8px;
}

.mode-card {
  border-radius:16px;
  padding:10px 10px;
  background:rgba(7,10,20,0.9);
  border:1px solid rgba(255,255,255,0.14);
  display:flex;
  align-items:center;
  gap:8px;
  cursor:pointer;
  transition:transform .12s ease,opacity .12s ease;
}

.mode-card:active {
  transform:scale(.97);
  opacity:.9;
}

.mode-icon {
  font-size:18px;
}

.mode-main {
  flex:1;
}

.mode-title {
  font-size:14px;
  font-weight:600;
}

.mode-sub {
  font-size:11px;
  opacity:.85;
}

.mode-tag {
  font-size:11px;
  padding:3px 8px;
  border-radius:999px;
  background:rgba(255,255,255,0.08);
}

/* —Å–ø–∏—Å–∫–∏ */

.list-rows {
  display:flex;
  flex-direction:column;
  gap:6px;
  margin-top:4px;
}

.row-item {
  border-radius:12px;
  padding:8px 9px;
  background:rgba(7,10,20,0.9);
  border:1px solid rgba(255,255,255,0.12);
  display:flex;
  align-items:center;
  gap:8px;
  font-size:13px;
}

.row-main {
  flex:1;
}

.row-title {
  font-weight:500;
}

.row-sub {
  font-size:11px;
  opacity:.8;
}

.row-tag {
  font-size:11px;
  padding:3px 8px;
  border-radius:999px;
  background:rgba(255,255,255,0.06);
}

/* –∫–Ω–æ–ø–∫–∏ */

.btn-secondary {
  margin-top:6px;
  padding:9px 12px;
  border-radius:999px;
  width:100%;
  border:1px solid rgba(255,255,255,0.18);
  background:transparent;
  color:rgba(215,230,255,0.9);
  font-size:13px;
  cursor:pointer;
  transition:opacity .15s ease,transform .15s ease;
}

.btn-secondary:active {
  transform:translateY(1px);
  opacity:.85;
}

/* –Ω–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */

.bottom-nav {
  position:fixed;
  left:0;
  right:0;
  bottom:0;
  padding:8px 14px 10px;
  display:flex;
  justify-content:center;
  gap:10px;
  background:transparent;
  backdrop-filter:none;
  -webkit-backdrop-filter:none;
  border-top:none;
  z-index:10;
}

.bottom-nav.nav-buttons-hidden {
  pointer-events:none;
}

.bottom-nav.nav-buttons-hidden .nav-pill {
  opacity:0;
  pointer-events:none;
  transform:scale(0.9);
}

.nav-pill {
  flex:0 0 32%;
  max-width:140px;
  border-radius:24px;
  padding:7px 4px 6px;
  border:1px solid rgba(255,255,255,0.3);
  background:linear-gradient(
    145deg,
    rgba(255,255,255,0.33),
    rgba(255,255,255,0.16)
  );
  backdrop-filter:blur(18px) saturate(190%);
  -webkit-backdrop-filter:blur(18px) saturate(190%);
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:2px;
  cursor:pointer;
  color:rgba(234,242,255,0.96);
  text-shadow:0 0 4px rgba(0,0,0,0.6);
  transition:transform .15s ease,box-shadow .15s ease,border-color .15s ease,opacity .15s ease;
  outline:none;
}

.nav-pill:focus,
.nav-pill:focus-visible {
  outline:none;
}

.nav-pill-icon {
  font-size:16px;
}

.nav-pill-label {
  font-size:11px;
}

.nav-pill-sub {
  font-size:10px;
  opacity:.9;
}

.nav-pill:active {
  transform:scale(.95);
  opacity:.9;
}

.nav-pill-active {
  border-color:rgba(130,200,255,0.95);
  box-shadow:
    0 0 18px rgba(120,200,255,0.55),
    0 10px 22px rgba(0,0,0,0.9);
}

/* –ø—å–µ–¥–µ—Å—Ç–∞–ª */

.podium {
  display:flex;
  align-items:flex-end;
  justify-content:center;
  gap:8px;
  margin-top:8px;
}

.podium-slot {
  flex:0 0 30%;
  border-radius:12px 12px 4px 4px;
  background:rgba(7,10,20,0.95);
  border:1px solid rgba(255,255,255,0.18);
  padding:6px 4px;
  text-align:center;
}

.podium-slot.gold {
  box-shadow:0 0 18px rgba(255,215,0,0.7);
}

.podium-place {
  font-size:11px;
  opacity:.8;
}

.podium-name {
  font-size:12px;
  font-weight:600;
}

.podium-score {
  font-size:11px;
}

.podium-stars {
  font-size:13px;
}

.podium-1 { height:78px; }
.podium-2 { height:64px; }
.podium-3 { height:56px; }

/* –ü—Ä–æ—Ñ–∏–ª—å */

.profile-section-label {
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:0.12em;
  opacity:.75;
  margin-top:4px;
}

.profile-ach-header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-top:10px;
}

.profile-ach-link {
  font-size:11px;
  text-decoration:underline;
  opacity:.9;
  background:none;
  border:none;
  padding:0;
  color:inherit;
  cursor:pointer;
}

.profile-character {
  margin-top:4px;
}

.character-frame {
  border-radius:18px;
  padding:14px;
  background:radial-gradient(circle at 0% 0%,rgba(126,202,255,0.25),rgba(7,10,20,0.97));
  border:1px solid rgba(255,255,255,0.2);
  display:flex;
  align-items:center;
  justify-content:center;
  min-height:140px;
}

.character-placeholder {
  font-size:12px;
  text-align:center;
  opacity:.9;
}

.stat-grid {
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:8px;
  margin-top:6px;
}

.stat-card {
  border-radius:14px;
  padding:8px 8px;
  background:rgba(7,10,20,0.9);
  border:1px solid rgba(255,255,255,0.14);
  display:flex;
  flex-direction:column;
  gap:3px;
}

.stat-label {
  font-size:11px;
  opacity:.78;
}

.stat-value {
  font-size:14px;
  font-weight:600;
}

.stat-sub {
  font-size:10px;
  opacity:.7;
}

.showcase-grid {
  display:flex;
  gap:8px;
  margin-top:6px;
}

.showcase-card {
  flex:1;
  border-radius:14px;
  padding:8px;
  background:rgba(7,10,20,0.9);
  border:1px solid rgba(255,255,255,0.18);
  font-size:11px;
}

.showcase-title {
  font-weight:600;
  margin-bottom:2px;
}

.showcase-sub {
  opacity:.8;
}

/* ---------- –≠–ö–†–ê–ù –ò–ì–†–´ ---------- */

.game-header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}

.game-title {
  font-size:14px;
  font-weight:600;
}

.game-back-btn {
  font-size:11px;
  padding:4px 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,0.2);
  background:rgba(7,10,20,0.9);
  color:inherit;
  cursor:pointer;
}

.game-back-btn:active {
  transform:scale(.97);
  opacity:.9;
}

.game-stats-row {
  display:flex;
  gap:8px;
  margin-top:8px;
}

.game-stat {
  flex:1;
  border-radius:12px;
  padding:6px 8px;
  background:rgba(7,10,20,0.9);
  border:1px solid rgba(255,255,255,0.14);
  font-size:11px;
}

.game-stat-label {
  opacity:.75;
}

.game-stat-value {
  margin-top:2px;
  font-size:13px;
  font-weight:600;
}

.game-progress {
  margin-top:8px;
}

.game-progress-bar {
  width:100%;
  height:6px;
  border-radius:999px;
  background:rgba(255,255,255,0.15);
  overflow:hidden;
  position:relative;
}

.game-progress-fill {
  position:absolute;
  left:0;
  top:0;
  height:100%;
  width:0%;
  border-radius:999px;
}

#game-progress-fill-bot {
  background:linear-gradient(90deg,#ff9b5c,#ff5c7a);
  opacity:.6;
}

#game-progress-fill {
  background:linear-gradient(90deg,#7ecaff,#50ffce);
}

/* –∂–∏–∑–Ω–∏ */

.game-lives {
  margin-top:6px;
  display:flex;
  align-items:center;
  gap:6px;
  font-size:11px;
  opacity:.85;
}

.game-lives-dots {
  display:flex;
  gap:4px;
  flex-wrap:wrap;
}

.life-heart {
  width:14px;
  height:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:14px;
}

.life-heart::before {
  content:"‚ù§";
  color:#ff4b6a;
}

.life-heart-lost::before {
  content:"üíî";
  color:#222;
  text-shadow:none;
}

/* –ø–æ–ª–µ —Ç–µ–∫—Å—Ç–∞ */

.game-lines {
  margin-top:10px;
  border-radius:14px;
  padding:10px;
  background:rgba(7,10,20,0.95);
  border:1px solid rgba(255,255,255,0.18);
  font-family:"SF Mono",ui-monospace,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
  position:relative;
  height:110px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  overflow:hidden;
  width:100%;
  max-width:100%;
}

.game-lines.loading .game-line {
  visibility:hidden;
}

.game-line {
  min-height:0;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.game-line-prev {
  opacity:.45;
  margin-bottom:4px;
  font-size:16px;
}

.game-line-current {
  margin:2px 0;
  width:100%;
}

.game-line-next {
  opacity:.45;
  margin-top:4px;
  font-size:16px;
}

/* –±–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞ */

.game-scroll-wrapper {
  display:flex;
  align-items:center;
  gap:3px;
}

.game-scroll-marker {
  width:2px;
  align-self:stretch;
  border-radius:2px;
  background:rgba(126,202,255,0.9);
  box-shadow:0 0 6px rgba(126,202,255,0.8);
}

.game-scroll-viewport {
  flex:1;
  overflow:hidden;
  width:100%;
  max-width:100%;
}

.game-scroll-inner {
  display:inline-flex;
  font-size:24px;
  line-height:1.1;
  transform:translateX(0);
  transition:transform .08s linear;
  will-change:transform;
}

.game-scroll-char {
  display:inline-block;
  width:1ch;
  color:rgba(220,230,245,0.35);
}

.game-scroll-char.active-char {
  color:#7ecaff;
  text-shadow:0 0 6px rgba(126,202,255,0.9);
}

/* countdown */

.game-countdown {
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
  font-size:28px;
  font-weight:700;
  text-shadow:0 0 18px rgba(0,0,0,0.9);
}

/* KEYBOARD + MATRIX */

.game-keyboard-wrapper {
  position:fixed;
  left:50%;
  bottom:0;
  transform:translateX(-50%);
  width:100%;
  max-width:480px;
  z-index:20;
  pointer-events:none;
}

.matrix-island {
  position:absolute;
  left:0;
  right:0;
  bottom:0;
  height:26vh;
  border-radius:40px 40px 0 0;
  background:radial-gradient(circle at 0% 0%,rgba(0,255,128,0.22),rgba(5,10,8,0.98));
  border:1px solid rgba(120,255,170,0.55);
  box-shadow:
    0 0 16px rgba(0,255,128,0.45),
    0 0 34px rgba(0,160,90,0.55);
  overflow:hidden;
  opacity:0;
  transform-origin:50% 100%;
  transition:opacity .15s ease;
}

/* –æ—Å—Ç—Ä–æ–≤–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –≤ –º–∞—Ç—á–µ */
body.in-game .matrix-island {
  opacity:1;
}

.matrix-char {
  position:absolute;
  top:-15%;
  font-family:"SF Mono",ui-monospace,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
  font-size:12px;
  color:#4bff8a;
  text-shadow:0 0 6px rgba(0,255,128,0.9);
  opacity:.8;
  animation-name:matrix-fall-char;
  animation-timing-function:linear;
  animation-iteration-count:infinite;
}

@keyframes matrix-fall-char {
  0% { transform:translateY(-120%); opacity:0; }
  10% { opacity:0.9; }
  100% { transform:translateY(120%); opacity:0; }
}

.game-keyboard {
  position:absolute;
  left:0;
  right:0;
  bottom:12px;
  padding:0 10px 4px;
  pointer-events:auto;
}

.keyboard-plate {
  width:100%;
  border-radius:18px 18px 10px 10px;
  padding:6px 4px 10px;
  background:rgba(10,12,12,0.98);
  border:1px solid rgba(120,255,170,0.25);
  backdrop-filter:blur(18px) saturate(180%);
  -webkit-backdrop-filter:blur(18px) saturate(180%);
  box-shadow:
    0 -2px 14px rgba(0,0,0,0.85),
    0 0 10px rgba(0,0,0,0.5);
}

/* ‚Äú–≤—Å–∞—Å—ã–≤–∞–Ω–∏–µ‚Äù —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω–æ–π –ø–ª–∏—Ç—ã */

.keyboard-plate.keyboard-hide {
  animation:keyboard-suck-out .5s ease forwards;
  pointer-events:none;
}

@keyframes keyboard-suck-out {
  0% {
    transform:translateY(0) scale(1);
    opacity:1;
  }
  100% {
    transform:translateY(40px) scale(0.7);
    opacity:0;
  }
}

/* —Å—Ç—Ä–æ–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã */

.key-row {
  display:flex;
  gap:4px;
  justify-content:space-between;
}

.key-row + .key-row {
  margin-top:4px;
}

.key-row-third {
  display:grid;
  grid-template-columns:repeat(11,minmax(0,1fr));
  gap:4px;
}

.key-spacer {
  pointer-events:none;
}

.key-row-space {
  justify-content:space-between;
}

/* —Å–∞–º–∏ –∫–ª–∞–≤–∏—à–∏ ‚Äî –º–∞—Ç—Ä–∏—á–Ω—ã–π —Å—Ç–∏–ª—å */

.key-btn {
  flex:1 1 0;
  min-width:0;
  padding:9px 4px;
  border-radius:9px;
  border:1px solid rgba(120,255,170,0.35);
  background:rgba(5,15,10,0.96);
  font-size:20px;
  color:#7dff92;
  cursor:pointer;
  box-shadow:
    0 0 7px rgba(0,255,128,0.5),
    0 1px 3px rgba(0,0,0,0.8);
  text-shadow:0 0 5px rgba(0,255,128,0.9);
}

.key-btn-small {
  flex:0 0 14%;
  max-width:14%;
  padding-inline:2px;
  font-size:18px;
}

.key-btn-wide {
  flex:1;
  max-width:none;
}

.key-btn:active {
  transform:scale(.97);
  opacity:.9;
  background:rgba(12,26,18,0.98);
  box-shadow:
    inset 0 1px 2px rgba(0,0,0,0.7),
    0 0 8px rgba(0,255,128,0.6);
}

/* summary + –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ –º–∞—Ç—á–∞ */

.game-summary {
  margin-top:12px;
  border-radius:14px;
  padding:10px;
  background:rgba(7,10,20,0.95);
  border:1px solid rgba(255,255,255,0.2);
  font-size:12px;
}

.game-actions {
  margin-top:8px;
  display:flex;
  gap:8px;
}

.game-actions .btn-secondary {
  margin-top:0;
}

/* TRAINING MENU */

.training-extra {
  margin-top:8px;
}

.training-subtitle {
  font-size:11px;
  opacity:.75;
  margin-bottom:4px;
}

.training-btn-row {
  display:flex;
  gap:8px;
  margin-top:6px;
}

.training-inline-btn {
  flex:1;
  border-radius:999px;
  padding:6px 8px;
  font-size:12px;
  border:1px solid rgba(255,255,255,0.2);
  background:rgba(7,10,20,0.9);
  color:inherit;
  cursor:pointer;
}

.training-inline-btn:active {
  transform:scale(.97);
  opacity:.9;
}

/* –ê–¥–∞–ø—Ç–∏–≤ */

@media (max-width:360px) {
  .app {
    padding:10px;
    padding-top:calc(100px + env(safe-area-inset-top, 0px));
    padding-bottom:80px;
  }
  body.in-game .app {padding-bottom:8px;}
  .glass-card {padding:14px 12px 16px;}
  .glass-card.game-mode {padding-bottom:100px;}
  .game-keyboard {
    bottom:8px;
    padding:0 8px 4px;
  }
  .key-btn {font-size:18px;}
}

@media (min-width:420px) {
  .game-keyboard {
    bottom:14px;
  }
}
